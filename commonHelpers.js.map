{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["import iziToast from \"izitoast\";\n// Додатковий імпорт стилів\nimport \"izitoast/dist/css/iziToast.min.css\";\nimport SimpleLightbox from \"simplelightbox\";\n// Додатковий імпорт стилів\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport './css/styles.css';\nimport axios from \"axios\";\nconst API_KEY = '41917530-74216f8e6af2c90f64ec8c0b5';\nconst URL = \"https://pixabay.com/api/\";\nconst form = document.querySelector(\".form-inline\");\nconst containerEl = document.querySelector(\".card-container\")\nconst loadMoreBtn = document.querySelector(\".label\");\nconst preloader = document.getElementById(\"preloader\");\nconst queryParams = {\n    q: \"\",\n    page: 1,\n    maxPage: 0,\n    per_page: 40,\n};\nlet currentSearchQuery = \"\";\nconst hiddenClass = \"is-hidden\";\nfunction hide(button) {\n    button.classList.add(hiddenClass);\n}\n\nfunction show(button) {\n    button.classList.remove(hiddenClass);\n}\n\nfunction enable(button, preloader) {\n    preloader.classList.add(hiddenClass);\n    button.disabled = false;\n}\n\nfunction disable(button, preloader) {\n    preloader.classList.remove(hiddenClass);\n    button.disabled = true;\n}\nfunction showLoadingIndicator() {\n    containerEl.innerHTML = '<div class=\"loader\"></div>';\n}\nfunction hideLoadingIndicator() {\n    const loadingElement = containerEl.querySelector('.loader');\n    if (loadingElement) {\n        loadingElement.remove();\n    }\n}\nform.addEventListener(\"submit\", handleSearch);\nasync function handleSearch(event) {\n    event.preventDefault();\n    containerEl.innerHTML = \"\";\n    const form = event.currentTarget;\n    const picture = form.elements.picture.value.trim();\n    currentSearchQuery = picture;\n    queryParams.page = 1;\n    if (picture === \"\" || picture == null) {\n        iziToast.error({\n            title: \"Error\",\n            message: `❌Sorry, there are no images matching your search query. Please, try again!`,\n        })\n        containerEl.innerHTML = \"\";\n        hide(loadMoreBtn);\n        return;\n    }\n    showLoadingIndicator()\n    try {\n        const { hits, totalHits } = await serchPicture(picture);\n        if (hits && hits.length > 0) {\n            queryParams.maxPage = Math.ceil(totalHits / queryParams.per_page);\n            createPictureMarkup(hits, containerEl)\n            const lightbox = new SimpleLightbox('.card-container a', {\n                captionsData: 'alt',\n                captionPosition: 'bottom',\n                captionDelay: 250,\n            });\n            lightbox.refresh();\n            if (hits && hits.length > 0 && hits.length !== totalHits) {\n                show(loadMoreBtn);\n                loadMoreBtn.removeEventListener(\"click\", handleLoadMore);\n                loadMoreBtn.addEventListener(\"click\", handleLoadMore);\n            } else {\n                hide(loadMoreBtn);\n            }\n        } else {\n            containerEl.innerHTML = \"\";\n            iziToast.error({\n                title: \"Error\",\n                message: `❌Sorry, there are no images matching your search query. Please, try again!`,\n            })\n            hide(loadMoreBtn);\n        }\n    }\n    catch (err) {\n        console.log(err);\n    }\n    finally {\n        hideLoadingIndicator();\n        form.reset()\n    };\n}\nfunction serchPicture(picture, page = 1) {\n    return axios.get(URL, {\n        params: {\n            key: API_KEY,\n            q: picture,\n            image_type: \"photo\",\n            orientation: \"horizontal\",\n            safesearch: true,\n            per_page: 40,\n            page,\n        }\n    }).then((res) => {\n        return res.data;\n    });\n}\nasync function handleLoadMore() {\n    queryParams.page += 1;\n    disable(loadMoreBtn, preloader);\n    try {\n        const { hits } = await serchPicture(currentSearchQuery, queryParams.page)\n        createPictureMarkup(hits, containerEl)\n        const cardHeight = containerEl.querySelector('.picture-link').getBoundingClientRect().height;\n        window.scrollBy({ top: cardHeight * 3, behavior: 'smooth' });\n        const lightbox = new SimpleLightbox('.card-container a', {\n            captionsData: 'alt',\n            captionPosition: 'bottom',\n            captionDelay: 250,\n        });\n        lightbox.refresh();\n    } catch (err) {\n        console.log(err);\n    } finally {\n        enable(loadMoreBtn, preloader);\n        if (queryParams.page >= queryParams.maxPage) {\n            hide(loadMoreBtn);\n            iziToast.error({\n                title: \"Error\",\n                message: `\"We're sorry, but you've reached the end of search results.\"`,\n            })\n            loadMoreBtn.removeEventListener(\"click\", handleLoadMore);\n        } else {\n            show(loadMoreBtn);\n            loadMoreBtn.removeEventListener(\"click\", handleLoadMore);\n            loadMoreBtn.addEventListener(\"click\", handleLoadMore);\n        }\n    }\n}\nfunction createPictureMarkup(hits, containerEl) {\n    const markup = hits.map(({ webformatURL, likes, views, comments, downloads, largeImageURL }) => `<a href=\"${largeImageURL}\" class= \"picture-link\">\n    <img src = \"${webformatURL}\">\n    <div class= \"picture-content\">\n        <div class= \"picture-text\">\n            <span class= \"picture-title\">Likes</span>\n            <span class= \"picture-sub-title\">${likes}</span>\n        </div>\n        <div class= \"picture-text\">\n            <span class= \"picture-title\">Views</span>\n            <span class= \"picture-sub-title\">${views}</span>\n        </div>\n        <div class= \"picture-text\">\n            <span class= \"picture-title\">Comments</span>\n            <span class= \"picture-sub-title\">${comments}</span>\n        </div>\n        <div class= \"picture-text\">\n            <span class= \"picture-title\">Downloads</span>\n            <span class= \"picture-sub-title\">${downloads}</span>\n        </div>\n    </div>\n</a>`).join();\n    containerEl.insertAdjacentHTML(\"beforeend\", markup);\n}"],"names":["API_KEY","URL","form","containerEl","loadMoreBtn","preloader","queryParams","currentSearchQuery","hiddenClass","hide","button","show","enable","disable","showLoadingIndicator","hideLoadingIndicator","loadingElement","handleSearch","event","picture","iziToast","hits","totalHits","serchPicture","createPictureMarkup","SimpleLightbox","handleLoadMore","err","page","axios","res","cardHeight","markup","webformatURL","likes","views","comments","downloads","largeImageURL"],"mappings":"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"}