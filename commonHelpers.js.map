{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["import iziToast from \"izitoast\";\n// Додатковий імпорт стилів\nimport \"izitoast/dist/css/iziToast.min.css\";\nimport SimpleLightbox from \"simplelightbox\";\n// Додатковий імпорт стилів\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport './css/styles.css';\nimport axios from \"axios\";\nconst API_KEY = '41917530-74216f8e6af2c90f64ec8c0b5';\nconst URL = \"https://pixabay.com/api/\";\nconst formEl = document.querySelector(\".form-inline\");\nconst containerEl = document.querySelector(\".card-container\")\nconst loadMoreBtn = document.querySelector(\".label\");\nconst preloader = document.getElementById(\"preloader\");\nformEl.addEventListener(\"submit\", handleSearch);\nfunction showLoadingIndicator() {\n    containerEl.innerHTML = '<div class=\"loader\"></div>';\n}\nfunction hideLoadingIndicator() {\n    const loadingElement = containerEl.querySelector('.loader');\n    if (loadingElement) {\n        loadingElement.remove();\n    }\n}\nconst hiddenClass = \"is-hidden\";\nfunction hide(button) {\n    button.classList.add(hiddenClass);\n}\n\nfunction show(button) {\n    button.classList.remove(hiddenClass);\n}\n\nfunction enable(button, preloader) {\n    preloader.classList.add(hiddenClass);\n    button.disabled = false;\n}\n\nfunction disable(button, preloader) {\n    preloader.classList.remove(hiddenClass);\n    button.disabled = true;\n}\nconst queryParams = {\n    q: \"\",\n    page: 1,\n    maxPage: 0,\n    per_page: 40,\n};\nlet currentSearchQuery = \"\";\nasync function handleSearch(event) {\n    event.preventDefault();\n    containerEl.innerHTML = \"\";\n    const form = event.currentTarget;\n    const picture = form.elements.picture.value.trim();\n    currentSearchQuery = picture;\n    if (picture === \"\" || picture == null) {\n        iziToast.error({\n            title: \"Error\",\n            message: `❌Sorry, there are no images matching your search query. Please, try again!`,\n        })\n        containerEl.innerHTML = \"\";\n        hide(loadMoreBtn);\n        return;\n    }\n    showLoadingIndicator()\n    try {\n        const { hits, totalHits } = await serchPicture(picture);\n        if (hits && hits.length > 0) {\n            queryParams.maxPage = Math.ceil(totalHits / queryParams.per_page);\n            createPictureMarkup(hits, containerEl)\n            const lightbox = new SimpleLightbox('.card-container a', {\n                captionsData: 'alt',\n                captionPosition: 'bottom',\n                captionDelay: 250,\n            });\n            lightbox.refresh();\n            if (hits && hits.length > 0 && hits.length !== totalHits) {\n                show(loadMoreBtn);\n                loadMoreBtn.addEventListener(\"click\", handleLoadMore);\n            } else {\n                hide(loadMoreBtn);\n            }\n        } else {\n            containerEl.innerHTML = \"\";\n            iziToast.error({\n                title: \"Error\",\n                message: `❌Sorry, there are no images matching your search query. Please, try again!`,\n            })\n            hide(loadMoreBtn);\n        }\n    }\n    catch (err) {\n        console.log(err);\n    }\n    finally {\n        hideLoadingIndicator();\n        form.reset()\n    };\n}\nfunction serchPicture(picture, page = 1) {\n    return axios.get(URL, {\n        params: {\n            key: API_KEY,\n            q: picture,\n            image_type: \"photo\",\n            orientation: \"horizontal\",\n            safesearch: true,\n            per_page: 40,\n            page,\n        }\n    }).then((res) => {\n        return res.data;\n    });\n}\nfunction createPictureMarkup(hits, containerEl) {\n    const markup = hits.map(({ webformatURL, likes, views, comments, downloads, largeImageURL }) => `<a href=\"${largeImageURL}\" class= \"picture-link\">\n    <img src = \"${webformatURL}\">\n    <div class= \"picture-content\">\n        <div class= \"picture-text\">\n            <span class= \"picture-title\">Likes</span>\n            <span class= \"picture-sub-title\">${likes}</span>\n        </div>\n        <div class= \"picture-text\">\n            <span class= \"picture-title\">Views</span>\n            <span class= \"picture-sub-title\">${views}</span>\n        </div>\n        <div class= \"picture-text\">\n            <span class= \"picture-title\">Comments</span>\n            <span class= \"picture-sub-title\">${comments}</span>\n        </div>\n        <div class= \"picture-text\">\n            <span class= \"picture-title\">Downloads</span>\n            <span class= \"picture-sub-title\">${downloads}</span>\n        </div>\n    </div>\n</a>`).join();\n    containerEl.insertAdjacentHTML(\"beforeend\", markup);\n}\nasync function handleLoadMore() {\n    queryParams.page += 1;\n    disable(loadMoreBtn, preloader);\n    try {\n        const { hits } = await serchPicture(currentSearchQuery, queryParams.page)\n        createPictureMarkup(hits, containerEl)\n        const cardHeight = containerEl.querySelector('.picture-link').getBoundingClientRect().height;\n        window.scrollBy({ top: cardHeight * 3, behavior: 'smooth' });\n        const lightbox = new SimpleLightbox('.card-container a', {\n            captionsData: 'alt',\n            captionPosition: 'bottom',\n            captionDelay: 250,\n        });\n        lightbox.refresh();\n    } catch (err) {\n        console.log(err);\n    } finally {\n        enable(loadMoreBtn, preloader);\n        if (queryParams.page === queryParams.maxPage) {\n            hide(loadMoreBtn);\n            iziToast.error({\n                title: \"Error\",\n                message: `\"We're sorry, but you've reached the end of search results.\"`,\n            })\n            loadMoreBtn.removeEventListener(\"click\", handleLoadMore);\n        }\n    }\n}"],"names":["API_KEY","URL","formEl","containerEl","loadMoreBtn","preloader","handleSearch","showLoadingIndicator","hideLoadingIndicator","loadingElement","hiddenClass","hide","button","show","enable","disable","queryParams","currentSearchQuery","event","form","picture","iziToast","hits","totalHits","serchPicture","createPictureMarkup","SimpleLightbox","handleLoadMore","err","page","axios","res","markup","webformatURL","likes","views","comments","downloads","largeImageURL","cardHeight"],"mappings":"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"}